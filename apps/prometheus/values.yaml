# https://github.com/prometheus-community/helm-charts/blob/main/charts/kube-prometheus-stack/values.yaml
grafana:
  enabled: false
alertmanager:
  enabled: false
kubelet:
  enabled: true
  serviceMonitor:
    metricRelabelings:
      # Drop metrics with a lot of series
      - action: drop
        regex: 'apiserver_(request|response)_.+'
        sourceLabels: [__name__]
      - action: drop
        regex: 'etcd_request_.+'
        sourceLabels: [__name__]
      - action: drop
        regex: 'workqueue_.+'
        sourceLabels: [__name__]
kubeApiServer:
  enabled: true
  serviceMonitor:
    metricRelabelings:
      # Drop metrics with a lot of series
      - action: drop
        regex: 'apiserver_(request|response)_.+'
        sourceLabels: [__name__]
      - action: drop
        regex: 'etcd_request_.+'
        sourceLabels: [__name__]
      - action: drop
        regex: 'workqueue_.+'
        sourceLabels: [__name__]
nodeExporter:
  enabled: true
defaultRules:
  create: false
prometheus:
  prometheusSpec:
    scrapeInterval: 60s
    enableAdminAPI: true
    remoteWrite:
      - url: https://prometheus-prod-13-prod-us-east-0.grafana.net/api/prom/push
        basicAuth:
          username:
            name: remote-prometheus-write-credentials
            key: username
          password:
            name: remote-prometheus-write-credentials
            key: password
        queueConfig:
          maxBackoff: "60s"
          sampleAgeLimit: "1h"
          maxSamplesPerSend: 5000
        writeRelabelConfigs:
          # Drop series with specific metric names
          - sourceLabels: [job]
            regex: kubelet
            action: drop
          - sourceLabels: [job]
            regex: apiserver
            action: drop
